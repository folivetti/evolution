<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language PolyKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# language StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-comment">{-|
Module      : Control.Evolution 
Description : a generic evolutionary algorithm DSL
Copyright   : (c) Fabricio Olivetti de Franca, 2022
License     : GPL-3
Maintainer  : fabricio.olivetti@gmail.com
Stability   : experimental
Portability : POSIX

The evolution package supports the creation of evolutionary and bio-inspired algorithms
with an user friendly domain specific language.

The package provides the main reproduction and selection strategies, 
a DSL to describe the evolution process, a function that runs the 
evolution algorithm with support to concurrency, and a customizable
DSL to describe the Crossover and Mutation operators for specific
class of problems.

The main idea is that the user focus only on implementing the 
crossover and mutation operators, the individual representation,
a fitness function, and a random individual generator. After that,
the user can customize the main loop of the evolutionary process
using the DSL and without worrying about implementing the process.

__Warning:__ the main objective of this package is to create a minimal
DSL capable of describing (almost) every bio-inspired search algorithm. As such,
every new version can potentially break compatibility with the previous one.

Example - Simple GA:

Let's suppose we are working with a binary representation and we want
to support a one-point crossover, single point mutation, multi-point mutation.

We must first create a data type with the chromossome and a fitness field and
add support to `Eq, Ord` classes by comparing the fitness:

@
data Bin = Bin { _chromo :: [Bool]
               , _fit :: Double
               }
               
instance Eq Bin where
  t1 == t2 = _fit t1 == _fit t2
instance Ord Bin where
  t1 &lt;= t2 = _fit t1 &lt;= _fit t2
@

After that, we instantiate the `Solution` class to indicate
how to retrieve the fitness of the individual and check
whether it is feasible or not.

@
instance Solution Bin where
  _getFitness = _fit 
  _isFeasible = const 0.0 -- always feasible
@

Next, we instantiate the `EvoClass` to create
the DSL for the crossover and mutation operators:

@
instance EvoClass Bin where 
  data Crossover Bin = OnePoint deriving (Show, Read)
  data Mutation  Bin = SinglePoint | MultiPoints deriving (Show, Read)
@

Finally, we implement the required functions and create an `Interpreter`:

@
cx OnePoint [p1,p2] = do
  let c1 = _chromo p1
      c2 = _chromo p2
  ix &lt;- randomIndex (length c1)
  let c = take ix c1 \&lt;&gt; drop ix c2
  pure $ Bin c 0.0 -- the individual will be evaluated later
  
mut SinglePoint (Bin c f) = do
  ix &lt;- randomIndex (length c)
  let c' = swap ix c
  pure $ Bin c' 0.0
mut MultiPoints (Bin c f) = do
  c' &lt;- traverse swapRnd c  
  pure $ Bin c' 0.0
  
randomIndividual n = do
    c \&lt;- take n \&lt;$&gt; state randoms
    pure $ Bin c 0.0
    
-- how many True in the chromossome
fitness (Bin c _) = pure $ Bin c (length $ filter id c)

interpret :: Interpreter Test
interpret = Funs cx mut randomIndividual fitness
@

We can create a customized logger to store the information
at every generation.

@
logger :: Population a -&gt; IO ()
logger pop  = do
  let best  = getBestFitness pop
      worst = getBestFitness worst
      avg   = getAvgFitness
  print $ &quot;The best fitness is: &quot; \&lt;&gt; show best
  print $ &quot;The worst fitness is: &quot; \&lt;&gt; show worst
  print $ &quot;The avg fitness is: &quot; \&lt;&gt; show avg
@

Now you can define your evolutionary algorithm using the DSL and
run it using `runEvolution`

@
evo = Reproduce Generational 
        [With AllOf 
           :&gt; Cross OnePoint 2 0.3 (Tournament 2) 
           :&gt; Mutate SinglePoint 0.7 
           :&gt; Done
        ]

-- run the evolution with 100 individuals for 500 generations
-- and random seed `g`
runEvolution 500 100 logger evo g interpret
@

We can, for example, create a an evolutionary algorithm that 
creates two child population: one with crossover and mutation
and another with only mutation, and then we reproduce using 
tournament selection.

@
evo = Reproduce (Probabilistic (Tournament 2))
        [ With AllOf :&gt; Cross OnePoint 2 0.3 (Tournament 2) :&gt; Mutate SinglePoint 0.7 :&gt; Done
        , With AllOf :&gt; Mutate MultiPoints 0.9 :&gt; Done
        ]
@

We can even parse the evolution process from a file. If we have a file &quot;ga.evo&quot; with the content

@
Reproduce Generational 
    [With AllOf 
       :&gt; Cross OnePoint 2 0.3 (Tournament 2) 
       :&gt; Mutate SinglePoint 0.7 
       :&gt; Done
    ]
@

We can automatically parse as:

@
evo \&lt;- read \&lt;$&gt; readFile &quot;ga.evo&quot;
@

The evolution DSL is described as a reproduction operator
followed by a list of evolution cycles.

@
Reproduce \&lt;reproduction operator&gt; [\&lt;evolution cycle&gt;]
@

The evolution cycle can be either `Parent`, when you just want
to pass the current population, `&lt;operator&gt; :&gt; &lt;evolution cycle&gt;`, 
when you want to chain two operators, and `Done`, marking the end of
the cycle.

The operator can be 

@
Cross \&lt;crossover operator&gt; \&lt;n-parents&gt; \&lt;probability&gt; \&lt;selection operator&gt;
Mutate \&lt;mutation operator&gt; \&lt;probability&gt;
With \&lt;predicate&gt;
@

The `With` operator is used to filter the population and can be `AllOf` (no filter),
`Feasible`, `Infeasible`.

-}</span><span>
</span><span id="line-185"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Evolution</span><span> </span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Evolution.html#runEvolution"><span class="hs-identifier">runEvolution</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier">Rnd</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier">EvoClass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier">Population</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier">Solution</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier">Interpreter</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Reproduction"><span class="hs-identifier">Reproduction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Selection"><span class="hs-identifier">Selection</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier">Crossover</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier">Mutation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Predicate"><span class="hs-identifier">Predicate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier">Evolution</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier">EvoCycle</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Op"><span class="hs-identifier">Op</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">force</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-205"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span>
</span><span id="line-206"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Scheduler</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">traverseConcurrently</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Comp</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-208"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sum</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-211"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | A random element is the state monad with StdGen as a state</span><span>
</span><span id="line-214"></span><span class="hs-keyword">type</span><span> </span><span id="Rnd"><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-var">Rnd</span></a></span></span><span> </span><span id="local-6989586621679041699"><span class="annot"><a href="#local-6989586621679041699"><span class="hs-identifier hs-type">a</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679041699"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | A population of solutions is a vector </span><span>
</span><span id="line-217"></span><span class="hs-keyword">type</span><span> </span><span id="Population"><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-var">Population</span></a></span></span><span> </span><span id="local-6989586621679041698"><span class="annot"><a href="#local-6989586621679041698"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679041698"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | A Solution class must implement a function to </span><span>
</span><span id="line-220"></span><span class="hs-comment">-- evaluate this solution, a function to retrieve its fitness</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- and another function to check the feasibility of the solution.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- The evaluation function is inside the state monad as it may</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- need to sample some instances to evaluate (i.e., lexicase selection).</span><span>
</span><span id="line-225"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679041817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Solution"><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-var">Solution</span></a></span></span><span> </span><span id="local-6989586621679041817"><span class="annot"><a href="#local-6989586621679041817"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span id="_getFitness"><span class="annot"><a href="Control.Evolution.html#_getFitness"><span class="hs-identifier hs-type">_getFitness</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679041817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-227"></span><span>  </span><span id="_isFeasible"><span class="annot"><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-type">_isFeasible</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679041817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | The `Interpreter` data type stores all the necessary functions</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- for the evolution process. Each of these functions should</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- receive the type of operation as the first parameter and throw an error</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- in case an operator is unsupported:</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- `_cx OnePoint pop = myOnePoint pop`</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- `_cx NPoints  pop = error &quot;NPoints crossover not implemented for this algorithm&quot;`</span><span>
</span><span id="line-236"></span><span class="hs-keyword">data</span><span> </span><span id="Interpreter"><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier hs-var">Interpreter</span></a></span></span><span> </span><span id="local-6989586621679041771"><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Funs"><span class="annot"><a href="Control.Evolution.html#Funs"><span class="hs-identifier hs-var">Funs</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_cx"><span class="annot"><span class="annottext">Interpreter a -&gt; Crossover a -&gt; [a] -&gt; Rnd a
</span><a href="Control.Evolution.html#_cx"><span class="hs-identifier hs-var hs-var">_cx</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier hs-type">Crossover</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-237"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_mut"><span class="annot"><span class="annottext">Interpreter a -&gt; Mutation a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_mut"><span class="hs-identifier hs-var hs-var">_mut</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-238"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_create"><span class="annot"><span class="annottext">Interpreter a -&gt; Rnd a
</span><a href="Control.Evolution.html#_create"><span class="hs-identifier hs-var hs-var">_create</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-239"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_evaluate"><span class="annot"><span class="annottext">Interpreter a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_evaluate"><span class="hs-identifier hs-var hs-var">_evaluate</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041771"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-240"></span><span>                          </span><span class="hs-special">}</span><span> </span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Reproduction algorithms</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- * Generational: the children replaces the parent population</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- * KeepBest: generational but keeping the best individual (either from parent or child population)</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- * ReplaceWorst: replaces the worst individuals with new random solutions or sampled solutions from the parent</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- * Merge: merge all the populations from different generation process</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- * Probabilistic: sample individuals from the combined parent+child populations using a Selection strategy</span><span>
</span><span id="line-249"></span><span class="hs-keyword">data</span><span> </span><span id="Reproduction"><span class="annot"><a href="Control.Evolution.html#Reproduction"><span class="hs-identifier hs-var">Reproduction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Generational"><span class="annot"><a href="Control.Evolution.html#Generational"><span class="hs-identifier hs-var">Generational</span></a></span></span><span> </span><span>
</span><span id="line-250"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="KeepBest"><span class="annot"><a href="Control.Evolution.html#KeepBest"><span class="hs-identifier hs-var">KeepBest</span></a></span></span><span> </span><span>
</span><span id="line-251"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="ReplaceWorst"><span class="annot"><a href="Control.Evolution.html#ReplaceWorst"><span class="hs-identifier hs-var">ReplaceWorst</span></a></span></span><span> </span><span>
</span><span id="line-252"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Merge"><span class="annot"><a href="Control.Evolution.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span></span><span>
</span><span id="line-253"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Probabilistic"><span class="annot"><a href="Control.Evolution.html#Probabilistic"><span class="hs-identifier hs-var">Probabilistic</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span>
</span><span id="line-254"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041680"><span id="local-6989586621679041682"><span id="local-6989586621679041684"><span class="annot"><span class="annottext">Int -&gt; Reproduction -&gt; ShowS
[Reproduction] -&gt; ShowS
Reproduction -&gt; String
(Int -&gt; Reproduction -&gt; ShowS)
-&gt; (Reproduction -&gt; String)
-&gt; ([Reproduction] -&gt; ShowS)
-&gt; Show Reproduction
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Reproduction] -&gt; ShowS
$cshowList :: [Reproduction] -&gt; ShowS
show :: Reproduction -&gt; String
$cshow :: Reproduction -&gt; String
showsPrec :: Int -&gt; Reproduction -&gt; ShowS
$cshowsPrec :: Int -&gt; Reproduction -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041671"><span id="local-6989586621679041673"><span id="local-6989586621679041675"><span id="local-6989586621679041677"><span class="annot"><span class="annottext">ReadPrec [Reproduction]
ReadPrec Reproduction
Int -&gt; ReadS Reproduction
ReadS [Reproduction]
(Int -&gt; ReadS Reproduction)
-&gt; ReadS [Reproduction]
-&gt; ReadPrec Reproduction
-&gt; ReadPrec [Reproduction]
-&gt; Read Reproduction
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Reproduction]
$creadListPrec :: ReadPrec [Reproduction]
readPrec :: ReadPrec Reproduction
$creadPrec :: ReadPrec Reproduction
readList :: ReadS [Reproduction]
$creadList :: ReadS [Reproduction]
readsPrec :: Int -&gt; ReadS Reproduction
$creadsPrec :: Int -&gt; ReadS Reproduction
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | applies a reproduction algorithm on a list of populations. It returns a random population.</span><span>
</span><span id="line-257"></span><span id="local-6989586621679041764"><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-type">reproduce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679041764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Reproduction"><span class="hs-identifier hs-type">Reproduction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-258"></span><span id="reproduce"><span class="annot"><span class="annottext">reproduce :: Reproduction -&gt; [Population a] -&gt; Rnd (Population a)
</span><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var hs-var">reproduce</span></a></span></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="Control.Evolution.html#Generational"><span class="hs-identifier hs-var">Generational</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679041668"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041668"><span class="hs-identifier hs-var">pop</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041668"><span class="hs-identifier hs-var">pop</span></a></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="Control.Evolution.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span> </span><span id="local-6989586621679041667"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041667"><span class="hs-identifier hs-var">pops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Rnd (Population a))
-&gt; Population a -&gt; Rnd (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Population a] -&gt; Population a
forall a. [Vector a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.concat</span></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041667"><span class="hs-identifier hs-var">pops</span></a></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="Control.Evolution.html#KeepBest"><span class="hs-identifier hs-var">KeepBest</span></a></span><span> </span><span id="local-6989586621679041665"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041665"><span class="hs-identifier hs-var">pops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Rnd (Population a))
-&gt; Population a -&gt; Rnd (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Population a -&gt; Population a
forall a. Int -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041663"><span class="hs-identifier hs-var">npop</span></a></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Population a) -&gt; Population a -&gt; Population a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Population a
forall a. (Ord a, Eq a) =&gt; Vector a -&gt; Vector a
</span><a href="Control.Evolution.html#sortVec"><span class="hs-identifier hs-var">sortVec</span></a></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Population a) -&gt; Population a -&gt; Population a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Population a] -&gt; Population a
forall a. [Vector a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.concat</span></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041665"><span class="hs-identifier hs-var">pops</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679041663"><span class="annot"><span class="annottext">npop :: Int
</span><a href="#local-6989586621679041663"><span class="hs-identifier hs-var hs-var">npop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Int) -&gt; Population a -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Population a] -&gt; Population a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041665"><span class="hs-identifier hs-var">pops</span></a></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="Control.Evolution.html#ReplaceWorst"><span class="hs-identifier hs-var">ReplaceWorst</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041659"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">parents</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041658"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041658"><span class="hs-identifier hs-var">pops</span></a></span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">nChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">nParents</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041655"><span class="hs-identifier hs-var">children</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">nChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">nParents</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Rnd (Population a))
-&gt; Population a -&gt; Rnd (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Population a -&gt; Population a
forall a. Int -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">nParents</span></a></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Population a) -&gt; Population a -&gt; Population a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Population a
forall a. (Ord a, Eq a) =&gt; Vector a -&gt; Vector a
</span><a href="Control.Evolution.html#sortVec"><span class="hs-identifier hs-var">sortVec</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041655"><span class="hs-identifier hs-var">children</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Rnd (Population a))
-&gt; Population a -&gt; Rnd (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Population a -&gt; Population a
forall a. Int -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">nParents</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">nChildren</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">parents</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Population a -&gt; Population a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041655"><span class="hs-identifier hs-var">children</span></a></span><span> </span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679041656"><span class="annot"><span class="annottext">nParents :: Int
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var hs-var">nParents</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">parents</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679041657"><span class="annot"><span class="annottext">nChildren :: Int
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var hs-var">nChildren</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041655"><span class="hs-identifier hs-var">children</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679041655"><span class="annot"><span class="annottext">children :: Population a
</span><a href="#local-6989586621679041655"><span class="hs-identifier hs-var hs-var">children</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Population a] -&gt; Population a
forall a. [Vector a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.concat</span></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041658"><span class="hs-identifier hs-var">pops</span></a></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Probabilistic"><span class="hs-identifier hs-type">Probabilistic</span></a></span><span> </span><span id="local-6989586621679041652"><span class="annot"><span class="annottext">Selection
</span><a href="#local-6989586621679041652"><span class="hs-identifier hs-var">sel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041651"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041651"><span class="hs-identifier hs-var">parents</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041650"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041650"><span class="hs-identifier hs-var">pops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Population a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Population a) -&gt; StateT StdGen IO [a] -&gt; Rnd (Population a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT StdGen IO a -&gt; StateT StdGen IO [a]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041646"><span class="hs-identifier hs-var">nPop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection -&gt; Population a -&gt; StateT StdGen IO a
forall a. (Ord a, Solution a) =&gt; Selection -&gt; Population a -&gt; Rnd a
</span><a href="Control.Evolution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">Selection
</span><a href="#local-6989586621679041652"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041644"><span class="hs-identifier hs-var">everyone</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679041644"><span class="annot"><span class="annottext">everyone :: Population a
</span><a href="#local-6989586621679041644"><span class="hs-identifier hs-var hs-var">everyone</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Population a] -&gt; Population a
forall a. [Vector a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.concat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041651"><span class="hs-identifier hs-var">parents</span></a></span><span class="annot"><span class="annottext">Population a -&gt; [Population a] -&gt; [Population a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041650"><span class="hs-identifier hs-var">pops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679041646"><span class="annot"><span class="annottext">nPop :: Int
</span><a href="#local-6989586621679041646"><span class="hs-identifier hs-var hs-var">nPop</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041651"><span class="hs-identifier hs-var">parents</span></a></span><span>
</span><span id="line-274"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Rnd (Population a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reproduction must be applied to nonempty population&quot;</span></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span id="local-6989586621679041642"><span class="annot"><span class="annottext">Reproduction
</span><a href="#local-6989586621679041642"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Rnd (Population a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Rnd (Population a)) -&gt; String -&gt; Rnd (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported reproduction: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reproduction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="#local-6989586621679041642"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621679041854"><span class="annot"><a href="Control.Evolution.html#sortVec"><span class="hs-identifier hs-type">sortVec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679041854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679041854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679041854"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679041854"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-278"></span><span id="sortVec"><span class="annot"><span class="annottext">sortVec :: Vector a -&gt; Vector a
</span><a href="Control.Evolution.html#sortVec"><span class="hs-identifier hs-var hs-var">sortVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Vector a) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; (Vector a -&gt; [a]) -&gt; Vector a -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span>
</span><span id="line-279"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Control.Evolution.html#sortVec"><span class="hs-pragma hs-type">sortVec</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Selection algorithms</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- * Tournament: tournament selection, samples n solutions and returns the best</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- * RouletteWheel: roulette wheel, calculates the probability of choosing an individual proportional to its fitness and sample an individual using this probability distribution</span><span>
</span><span id="line-285"></span><span class="hs-keyword">data</span><span> </span><span id="Selection"><span class="annot"><a href="Control.Evolution.html#Selection"><span class="hs-identifier hs-var">Selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Tournament"><span class="annot"><a href="Control.Evolution.html#Tournament"><span class="hs-identifier hs-var">Tournament</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-286"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="RouletteWheel"><span class="annot"><a href="Control.Evolution.html#RouletteWheel"><span class="hs-identifier hs-var">RouletteWheel</span></a></span></span><span> </span><span>
</span><span id="line-287"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041631"><span id="local-6989586621679041633"><span id="local-6989586621679041635"><span class="annot"><span class="annottext">Int -&gt; Selection -&gt; ShowS
[Selection] -&gt; ShowS
Selection -&gt; String
(Int -&gt; Selection -&gt; ShowS)
-&gt; (Selection -&gt; String)
-&gt; ([Selection] -&gt; ShowS)
-&gt; Show Selection
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Selection] -&gt; ShowS
$cshowList :: [Selection] -&gt; ShowS
show :: Selection -&gt; String
$cshow :: Selection -&gt; String
showsPrec :: Int -&gt; Selection -&gt; ShowS
$cshowsPrec :: Int -&gt; Selection -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041623"><span id="local-6989586621679041625"><span id="local-6989586621679041627"><span id="local-6989586621679041629"><span class="annot"><span class="annottext">ReadPrec [Selection]
ReadPrec Selection
Int -&gt; ReadS Selection
ReadS [Selection]
(Int -&gt; ReadS Selection)
-&gt; ReadS [Selection]
-&gt; ReadPrec Selection
-&gt; ReadPrec [Selection]
-&gt; Read Selection
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Selection]
$creadListPrec :: ReadPrec [Selection]
readPrec :: ReadPrec Selection
$creadPrec :: ReadPrec Selection
readList :: ReadS [Selection]
$creadList :: ReadS [Selection]
readsPrec :: Int -&gt; ReadS Selection
$creadsPrec :: Int -&gt; ReadS Selection
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | selects a random individual from the population using the `Selection` strategy.</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- TODO: some strategies sample a bunch of solutions in a single pass (SUS)</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- this would require a modification on how selection is applied.</span><span>
</span><span id="line-292"></span><span id="local-6989586621679041836"><span class="annot"><a href="Control.Evolution.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679041836"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041836"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041836"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Rnd"><span class="hs-identifier hs-type">Rnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041836"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-293"></span><span id="select"><span class="annot"><span class="annottext">select :: Selection -&gt; Population a -&gt; Rnd a
</span><a href="Control.Evolution.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span class="annot"><span class="annottext">Selection
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679041622"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041622"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Bool
forall a. Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041622"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Rnd a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty population in selection&quot;</span></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Control.Evolution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Tournament"><span class="hs-identifier hs-type">Tournament</span></a></span><span> </span><span id="local-6989586621679041620"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041620"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041619"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041619"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679041618"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041618"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041617"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679041617"><span class="hs-identifier hs-var">ixs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT StdGen IO Int -&gt; StateT StdGen IO [Int]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041620"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; StateT StdGen IO Int
</span><a href="Control.Evolution.html#randomInt"><span class="hs-identifier hs-var">randomInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041619"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; Rnd a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Rnd a) -&gt; a -&gt; Rnd a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; a -&gt; [Int] -&gt; a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679041614"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041614"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679041613"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041619"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041614"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041619"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041618"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679041617"><span class="hs-identifier hs-var">ixs</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Control.Evolution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">Selection
</span><a href="Control.Evolution.html#RouletteWheel"><span class="hs-identifier hs-var">RouletteWheel</span></a></span><span> </span><span id="local-6989586621679041611"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041610"><span class="annot"><span class="annottext">fits :: Vector Double
</span><a href="#local-6989586621679041610"><span class="hs-identifier hs-var hs-var">fits</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Double) -&gt; Population a -&gt; Vector Double
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a. Solution a =&gt; a -&gt; Double
</span><a href="Control.Evolution.html#_getFitness"><span class="hs-identifier hs-var">_getFitness</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">pop</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span id="local-6989586621679041608"><span class="annot"><span class="annottext">tot :: Double
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var hs-var">tot</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679041610"><span class="hs-identifier hs-var">fits</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span id="local-6989586621679041606"><span class="annot"><span class="annottext">normFits :: Vector Double
</span><a href="#local-6989586621679041606"><span class="hs-identifier hs-var hs-var">normFits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Vector Double -&gt; Vector Double
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">tot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679041610"><span class="hs-identifier hs-var">fits</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span id="local-6989586621679041604"><span class="annot"><span class="annottext">cumsum :: Vector Double
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var hs-var">cumsum</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; Vector Double -&gt; Vector Double
forall a. (a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.scanl1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679041606"><span class="hs-identifier hs-var">normFits</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679041601"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041601"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO Double
</span><a href="Control.Evolution.html#randomDbl"><span class="hs-identifier hs-var">randomDbl</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041599"><span class="annot"><span class="annottext">mix :: Maybe Int
</span><a href="#local-6989586621679041599"><span class="hs-identifier hs-var hs-var">mix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Bool) -&gt; Vector Double -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">V.findIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041601"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">cumsum</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679041599"><span class="hs-identifier hs-var">mix</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rnd a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Rnd a) -&gt; a -&gt; Rnd a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679041596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041596"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rnd a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Rnd a) -&gt; a -&gt; Rnd a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041596"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Data family for Crossover and Mutation</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- as each algorithm/problem `t` has a different set of </span><span>
</span><span id="line-311"></span><span class="hs-comment">-- possible operators, the user must provide a data type</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- for Crossover and Mutation.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- See test/Specs.hs for an example.</span><span>
</span><span id="line-315"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier hs-type">Crossover</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier hs-type">Crossover</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="EvoClass"><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-var">EvoClass</span></a></span></span><span> </span><span id="local-6989586621679041595"><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="Crossover"><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier hs-var">Crossover</span></a></span></span><span> </span><span id="local-6989586621679041595"><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="Mutation"><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span></span><span> </span><span id="local-6989586621679041595"><span class="annot"><a href="#local-6989586621679041595"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Predicate for population filter </span><span>
</span><span id="line-320"></span><span class="hs-comment">--</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- * Feasible: selects only the feasible solutions</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- * Infeasible: selects only the infeasible solutions</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- * All: selects the entire population</span><span>
</span><span id="line-324"></span><span class="hs-keyword">data</span><span> </span><span id="Predicate"><span class="annot"><a href="Control.Evolution.html#Predicate"><span class="hs-identifier hs-var">Predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Feasible"><span class="annot"><a href="Control.Evolution.html#Feasible"><span class="hs-identifier hs-var">Feasible</span></a></span></span><span> </span><span>
</span><span id="line-325"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Infeasible"><span class="annot"><a href="Control.Evolution.html#Infeasible"><span class="hs-identifier hs-var">Infeasible</span></a></span></span><span>
</span><span id="line-326"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="AllOf"><span class="annot"><a href="Control.Evolution.html#AllOf"><span class="hs-identifier hs-var">AllOf</span></a></span></span><span>
</span><span id="line-327"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041586"><span id="local-6989586621679041588"><span id="local-6989586621679041590"><span class="annot"><span class="annottext">Int -&gt; Predicate -&gt; ShowS
[Predicate] -&gt; ShowS
Predicate -&gt; String
(Int -&gt; Predicate -&gt; ShowS)
-&gt; (Predicate -&gt; String)
-&gt; ([Predicate] -&gt; ShowS)
-&gt; Show Predicate
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Predicate] -&gt; ShowS
$cshowList :: [Predicate] -&gt; ShowS
show :: Predicate -&gt; String
$cshow :: Predicate -&gt; String
showsPrec :: Int -&gt; Predicate -&gt; ShowS
$cshowsPrec :: Int -&gt; Predicate -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041578"><span id="local-6989586621679041580"><span id="local-6989586621679041582"><span id="local-6989586621679041584"><span class="annot"><span class="annottext">ReadPrec [Predicate]
ReadPrec Predicate
Int -&gt; ReadS Predicate
ReadS [Predicate]
(Int -&gt; ReadS Predicate)
-&gt; ReadS [Predicate]
-&gt; ReadPrec Predicate
-&gt; ReadPrec [Predicate]
-&gt; Read Predicate
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Predicate]
$creadListPrec :: ReadPrec [Predicate]
readPrec :: ReadPrec Predicate
$creadPrec :: ReadPrec Predicate
readList :: ReadS [Predicate]
$creadList :: ReadS [Predicate]
readsPrec :: Int -&gt; ReadS Predicate
$creadsPrec :: Int -&gt; ReadS Predicate
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="local-6989586621679041780"><span class="annot"><a href="Control.Evolution.html#filterPop"><span class="hs-identifier hs-type">filterPop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041780"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="filterPop"><span class="annot"><span class="annottext">filterPop :: Predicate -&gt; Population a -&gt; Population a
</span><a href="Control.Evolution.html#filterPop"><span class="hs-identifier hs-var hs-var">filterPop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="Control.Evolution.html#Feasible"><span class="hs-identifier hs-var">Feasible</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Population a -&gt; Population a
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Solution a =&gt; a -&gt; Bool
</span><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-var">_isFeasible</span></a></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Control.Evolution.html#filterPop"><span class="hs-identifier hs-var">filterPop</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="Control.Evolution.html#Infeasible"><span class="hs-identifier hs-var">Infeasible</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Population a -&gt; Population a
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Solution a =&gt; a -&gt; Bool
</span><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-var">_isFeasible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span class="annot"><a href="Control.Evolution.html#filterPop"><span class="hs-identifier hs-var">filterPop</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="Control.Evolution.html#AllOf"><span class="hs-identifier hs-var">AllOf</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Population a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- | DSL of an evolutionary process</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- The evolutionary process is composed of a reproduction strategy between </span><span>
</span><span id="line-337"></span><span class="hs-comment">-- two evolutionary cycles applied to a filtered population.</span><span>
</span><span id="line-338"></span><span class="hs-keyword">data</span><span> </span><span id="Evolution"><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-var">Evolution</span></a></span></span><span> </span><span id="local-6989586621679041573"><span class="annot"><a href="#local-6989586621679041573"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Reproduce"><span class="annot"><a href="Control.Evolution.html#Reproduce"><span class="hs-identifier hs-var">Reproduce</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#Reproduction"><span class="hs-identifier hs-type">Reproduction</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-type">EvoCycle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041573"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span class="hs-comment">--  [(Predicate, EvoCycle t)]</span><span>
</span><span id="line-340"></span><span class="hs-comment">--data Evolution t = Reproduce Reproduction Predicate (EvoCycle t) Predicate (EvoCycle t)</span><span>
</span><span id="line-341"></span><span class="hs-comment">--  deriving (Show, Read)</span><span>
</span><span id="line-342"></span><span id="local-6989586621679041565"><span id="local-6989586621679041567"><span id="local-6989586621679041569"><span id="local-6989586621679041571"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041571"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-type">Evolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041571"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-343"></span><span id="local-6989586621679041556"><span id="local-6989586621679041558"><span id="local-6989586621679041560"><span id="local-6989586621679041562"><span id="local-6989586621679041564"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041564"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-type">Evolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041564"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | An evolution cycle is composed of a sequence of</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- crossover and mutation operations. The order and quantity of each operation </span><span>
</span><span id="line-347"></span><span class="hs-comment">-- is arbitrary.</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- * Cross: applies a `Crossover` operator to `n` individuals with `p` probability</span><span>
</span><span id="line-350"></span><span class="hs-comment">--          and sampling individuals using `Selection` strategy</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- * Mutate: applies a `Mutation` operator with probability `p`</span><span>
</span><span id="line-352"></span><span class="hs-comment">--</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Common evolution cycle: </span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- Cross OnePoint 2 0.8 (Tournament 2) </span><span>
</span><span id="line-356"></span><span class="hs-comment">--      (Mutate SwapTree 0.2 End)</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- With Local Search: </span><span>
</span><span id="line-359"></span><span class="hs-comment">--</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- Cross OnePoint 2 0.8 (Tournament 2) </span><span>
</span><span id="line-361"></span><span class="hs-comment">--      (Mutate SwapTree 0.2</span><span>
</span><span id="line-362"></span><span class="hs-comment">--         (Mutate LocalSearch 1.0 End))</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">--data EvoCycle t = Loop (Gen t)</span><span>
</span><span id="line-365"></span><span>                </span><span>
</span><span id="line-366"></span><span class="hs-keyword">data</span><span> </span><span id="EvoCycle"><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-var">EvoCycle</span></a></span></span><span> </span><span id="local-6989586621679041555"><span class="annot"><a href="#local-6989586621679041555"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Control.Evolution.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041555"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span id="%3A%3E"><span class="annot"><a href="Control.Evolution.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-type">EvoCycle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041555"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-367"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Done"><span class="annot"><a href="Control.Evolution.html#Done"><span class="hs-identifier hs-var">Done</span></a></span></span><span>
</span><span id="line-368"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Parent"><span class="annot"><a href="Control.Evolution.html#Parent"><span class="hs-identifier hs-var">Parent</span></a></span></span><span>
</span><span id="line-369"></span><span class="hs-keyword">data</span><span> </span><span id="Op"><span class="annot"><a href="Control.Evolution.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span id="local-6989586621679041551"><span class="annot"><a href="#local-6989586621679041551"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cross"><span class="annot"><a href="Control.Evolution.html#Cross"><span class="hs-identifier hs-var">Cross</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Crossover"><span class="hs-identifier hs-type">Crossover</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041551"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="Control.Evolution.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span>
</span><span id="line-370"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="Mutate"><span class="annot"><a href="Control.Evolution.html#Mutate"><span class="hs-identifier hs-var">Mutate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041551"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-371"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="With"><span class="annot"><a href="Control.Evolution.html#With"><span class="hs-identifier hs-var">With</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621679041541"><span id="local-6989586621679041543"><span id="local-6989586621679041545"><span id="local-6989586621679041547"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041547"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-type">EvoCycle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-374"></span><span id="local-6989586621679041532"><span id="local-6989586621679041534"><span id="local-6989586621679041536"><span id="local-6989586621679041538"><span id="local-6989586621679041540"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041540"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-type">EvoCycle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041540"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-375"></span><span id="local-6989586621679041525"><span id="local-6989586621679041527"><span id="local-6989586621679041529"><span id="local-6989586621679041531"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041531"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-376"></span><span id="local-6989586621679041516"><span id="local-6989586621679041518"><span id="local-6989586621679041520"><span id="local-6989586621679041522"><span id="local-6989586621679041524"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoClass"><span class="hs-identifier hs-type">EvoClass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041524"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041524"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Control.Evolution.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Control.Evolution.html#randomDbl"><span class="hs-identifier hs-type">randomDbl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-381"></span><span id="randomDbl"><span class="annot"><span class="annottext">randomDbl :: StateT StdGen IO Double
</span><a href="Control.Evolution.html#randomDbl"><span class="hs-identifier hs-var hs-var">randomDbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; (Double, StdGen)) -&gt; StateT StdGen IO Double
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double) -&gt; StdGen -&gt; (Double, StdGen)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="Control.Evolution.html#randomInt"><span class="hs-identifier hs-type">randomInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-384"></span><span id="randomInt"><span class="annot"><span class="annottext">randomInt :: (Int, Int) -&gt; StateT StdGen IO Int
</span><a href="Control.Evolution.html#randomInt"><span class="hs-identifier hs-var hs-var">randomInt</span></a></span></span><span> </span><span id="local-6989586621679041513"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679041513"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; (Int, StdGen)) -&gt; StateT StdGen IO Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; (Int, StdGen)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679041513"><span class="hs-identifier hs-var">rng</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Evaluates an evolution cycle.</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- Each step involves the immutable population as a context</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- and an individual as focus.</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- By the end of the cycle, a single individual will be created.</span><span>
</span><span id="line-390"></span><span id="local-6989586621679041782"><span class="annot"><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-type">evalCycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#EvoCycle"><span class="hs-identifier hs-type">EvoCycle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-392"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-393"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-394"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679041782"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-395"></span><span id="evalCycle"><span class="annot"><span class="annottext">evalCycle :: EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
</span><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var hs-var">evalCycle</span></a></span></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="Control.Evolution.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span> </span><span id="local-6989586621679041511"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041511"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679041510"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041510"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041510"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="Control.Evolution.html#Parent"><span class="hs-identifier hs-var">Parent</span></a></span><span> </span><span id="local-6989586621679041509"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041509"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679041508"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041508"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041508"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#With"><span class="hs-identifier hs-type">With</span></a></span><span> </span><span id="local-6989586621679041507"><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679041507"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679041506"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041506"><span class="hs-identifier hs-var">evo</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041505"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041505"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679041504"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041504"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall a.
(Solution a, NFData a) =&gt;
EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
</span><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041506"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Predicate -&gt; Population a -&gt; Population a
forall a. Solution a =&gt; Predicate -&gt; Population a -&gt; Population a
</span><a href="Control.Evolution.html#filterPop"><span class="hs-identifier hs-var">filterPop</span></a></span><span> </span><span class="annot"><span class="annottext">Predicate
</span><a href="#local-6989586621679041507"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041505"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041504"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Cross"><span class="hs-identifier hs-type">Cross</span></a></span><span> </span><span id="local-6989586621679041503"><span class="annot"><span class="annottext">Crossover a
</span><a href="#local-6989586621679041503"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679041502"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041502"><span class="hs-identifier hs-var">nParents</span></a></span></span><span> </span><span id="local-6989586621679041501"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041501"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span id="local-6989586621679041500"><span class="annot"><span class="annottext">Selection
</span><a href="#local-6989586621679041500"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679041499"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041499"><span class="hs-identifier hs-var">evo</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041498"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041498"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041497"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041497"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679041496"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041496"><span class="hs-identifier hs-var">prob</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO Double
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) Double
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO Double
</span><a href="Control.Evolution.html#randomDbl"><span class="hs-identifier hs-var">randomDbl</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679041494"><span class="annot"><span class="annottext">Crossover a -&gt; [a] -&gt; Rnd a
</span><a href="#local-6989586621679041494"><span class="hs-identifier hs-var">cxf</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; Crossover a -&gt; [a] -&gt; Rnd a)
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Crossover a -&gt; [a] -&gt; Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; Crossover a -&gt; [a] -&gt; Rnd a
forall a. Interpreter a -&gt; Crossover a -&gt; [a] -&gt; Rnd a
</span><a href="Control.Evolution.html#_cx"><span class="hs-identifier hs-var hs-var">_cx</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-comment">--choose  &lt;- asks _select</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679041492"><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041492"><span class="hs-identifier hs-var">eval</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; a -&gt; Rnd a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (a -&gt; Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; a -&gt; Rnd a
forall a. Interpreter a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_evaluate"><span class="hs-identifier hs-var hs-var">_evaluate</span></a></span><span> </span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679041491"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041491"><span class="hs-identifier hs-var">parents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO [a]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(StateT StdGen IO [a]
 -&gt; ReaderT (Interpreter a) (StateT StdGen IO) [a])
-&gt; StateT StdGen IO [a]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rnd a -&gt; StateT StdGen IO [a]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041502"><span class="hs-identifier hs-var">nParents</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection -&gt; Population a -&gt; Rnd a
forall a. (Ord a, Solution a) =&gt; Selection -&gt; Population a -&gt; Rnd a
</span><a href="Control.Evolution.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">Selection
</span><a href="#local-6989586621679041500"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041498"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679041490"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041490"><span class="hs-identifier hs-var">child</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041496"><span class="hs-identifier hs-var">prob</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041501"><span class="hs-identifier hs-var">pc</span></a></span><span>
</span><span id="line-406"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rnd a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Crossover a -&gt; [a] -&gt; Rnd a
</span><a href="#local-6989586621679041494"><span class="hs-identifier hs-var">cxf</span></a></span><span> </span><span class="annot"><span class="annottext">Crossover a
</span><a href="#local-6989586621679041503"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041491"><span class="hs-identifier hs-var">parents</span></a></span><span> </span><span class="annot"><span class="annottext">Rnd a -&gt; (a -&gt; Rnd a) -&gt; Rnd a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041492"><span class="hs-identifier hs-var">eval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a)
-&gt; a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041491"><span class="hs-identifier hs-var">parents</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall a.
(Solution a, NFData a) =&gt;
EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
</span><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041499"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041498"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041490"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Mutate"><span class="hs-identifier hs-type">Mutate</span></a></span><span> </span><span id="local-6989586621679041488"><span class="annot"><span class="annottext">Mutation a
</span><a href="#local-6989586621679041488"><span class="hs-identifier hs-var">mut</span></a></span></span><span> </span><span id="local-6989586621679041487"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041487"><span class="hs-identifier hs-var">pm</span></a></span></span><span> </span><span class="annot"><a href="Control.Evolution.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span id="local-6989586621679041486"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041486"><span class="hs-identifier hs-var">evo</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041485"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041485"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041484"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041484"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679041483"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041483"><span class="hs-identifier hs-var">prob</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO Double
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) Double
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO Double
</span><a href="Control.Evolution.html#randomDbl"><span class="hs-identifier hs-var">randomDbl</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679041482"><span class="annot"><span class="annottext">Mutation a -&gt; a -&gt; Rnd a
</span><a href="#local-6989586621679041482"><span class="hs-identifier hs-var">mutf</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; Mutation a -&gt; a -&gt; Rnd a)
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Mutation a -&gt; a -&gt; Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; Mutation a -&gt; a -&gt; Rnd a
forall a. Interpreter a -&gt; Mutation a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_mut"><span class="hs-identifier hs-var hs-var">_mut</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679041481"><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041481"><span class="hs-identifier hs-var">eval</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; a -&gt; Rnd a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (a -&gt; Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; a -&gt; Rnd a
forall a. Interpreter a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_evaluate"><span class="hs-identifier hs-var hs-var">_evaluate</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621679041480"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041480"><span class="hs-identifier hs-var">child</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041483"><span class="hs-identifier hs-var">prob</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679041487"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-415"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rnd a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mutation a -&gt; a -&gt; Rnd a
</span><a href="#local-6989586621679041482"><span class="hs-identifier hs-var">mutf</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation a
</span><a href="#local-6989586621679041488"><span class="hs-identifier hs-var">mut</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Rnd a -&gt; (a -&gt; Rnd a) -&gt; Rnd a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041481"><span class="hs-identifier hs-var">eval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041484"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall a.
(Solution a, NFData a) =&gt;
EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
</span><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041486"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041485"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041480"><span class="hs-identifier hs-var">child</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- | Evaluates the evolution process in parallel</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- The evolution process generates two branches with each</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- branch generating a population. After that, it apples the</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- reproduction strategy to generate the next population.</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- Each individual of the new populations are generated in parallel </span><span>
</span><span id="line-424"></span><span class="hs-comment">-- using the evolution cycle. </span><span>
</span><span id="line-425"></span><span id="local-6989586621679041730"><span class="annot"><a href="Control.Evolution.html#evalEvo"><span class="hs-identifier hs-type">evalEvo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-type">Evolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span>
</span><span id="line-428"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041730"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-430"></span><span id="evalEvo"><span class="annot"><span class="annottext">evalEvo :: Evolution a
-&gt; Population a
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
</span><a href="Control.Evolution.html#evalEvo"><span class="hs-identifier hs-var hs-var">evalEvo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Reproduce"><span class="hs-identifier hs-type">Reproduce</span></a></span><span> </span><span id="local-6989586621679041478"><span class="annot"><span class="annottext">Reproduction
</span><a href="#local-6989586621679041478"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Population a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty evolution cycle&quot;</span></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Control.Evolution.html#evalEvo"><span class="hs-identifier hs-var">evalEvo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Reproduce"><span class="hs-identifier hs-type">Reproduce</span></a></span><span> </span><span id="local-6989586621679041477"><span class="annot"><span class="annottext">Reproduction
</span><a href="#local-6989586621679041477"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679041476"><span class="annot"><span class="annottext">[EvoCycle a]
</span><a href="#local-6989586621679041476"><span class="hs-identifier hs-var">evos</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041475"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041475"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679041474"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041474"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621679041473"><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041473"><span class="hs-identifier hs-var">config</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (Interpreter a) (StateT StdGen IO) (Interpreter a)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679041471"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041471"><span class="hs-identifier hs-var">pops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041470"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041470"><span class="hs-identifier hs-var">gs'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[EvoCycle a]
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) ([Population a], [StdGen])
</span><a href="#local-6989586621679041469"><span class="hs-identifier hs-var">runEvo</span></a></span><span> </span><span class="annot"><span class="annottext">[EvoCycle a]
</span><a href="#local-6989586621679041476"><span class="hs-identifier hs-var">evos</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041474"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span id="local-6989586621679041468"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041468"><span class="hs-identifier hs-var">pop'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO (Population a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(StateT StdGen IO (Population a)
 -&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a))
-&gt; StateT StdGen IO (Population a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reproduction -&gt; [Population a] -&gt; StateT StdGen IO (Population a)
forall a.
(Ord a, Solution a) =&gt;
Reproduction -&gt; [Population a] -&gt; Rnd (Population a)
</span><a href="Control.Evolution.html#reproduce"><span class="hs-identifier hs-var">reproduce</span></a></span><span> </span><span class="annot"><span class="annottext">Reproduction
</span><a href="#local-6989586621679041477"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041471"><span class="hs-identifier hs-var">pops</span></a></span><span> </span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><span class="annottext">(Population a, [StdGen])
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041468"><span class="hs-identifier hs-var">pop'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041470"><span class="hs-identifier hs-var">gs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>      </span><span id="local-6989586621679041469"><span class="annot"><span class="annottext">runEvo :: [EvoCycle a]
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) ([Population a], [StdGen])
</span><a href="#local-6989586621679041469"><span class="hs-identifier hs-var hs-var">runEvo</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679041467"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041467"><span class="hs-identifier hs-var">gs1</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Population a], [StdGen])
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) ([Population a], [StdGen])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041467"><span class="hs-identifier hs-var">gs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><a href="#local-6989586621679041469"><span class="hs-identifier hs-var">runEvo</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041466"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041466"><span class="hs-identifier hs-var">evo</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041465"><span class="annot"><span class="annottext">[EvoCycle a]
</span><a href="#local-6989586621679041465"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041464"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041464"><span class="hs-identifier hs-var">gs1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679041463"><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041463"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (Interpreter a) (StateT StdGen IO) (Interpreter a)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-440"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041462"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041462"><span class="hs-identifier hs-var">pop'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041461"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041461"><span class="hs-identifier hs-var">gs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Interpreter a
-&gt; [StdGen]
-&gt; Population a
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
</span><a href="#local-6989586621679041460"><span class="hs-identifier hs-var">runPar</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041466"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041463"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041464"><span class="hs-identifier hs-var">gs1</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041475"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-comment">--(filterPop pred pop)</span><span>
</span><span id="line-441"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041459"><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041459"><span class="hs-identifier hs-var">pops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041458"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041458"><span class="hs-identifier hs-var">gs3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[EvoCycle a]
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) ([Population a], [StdGen])
</span><a href="#local-6989586621679041469"><span class="hs-identifier hs-var">runEvo</span></a></span><span> </span><span class="annot"><span class="annottext">[EvoCycle a]
</span><a href="#local-6989586621679041465"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041461"><span class="hs-identifier hs-var">gs2</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">([Population a], [StdGen])
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) ([Population a], [StdGen])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041462"><span class="hs-identifier hs-var">pop'</span></a></span><span class="annot"><span class="annottext">Population a -&gt; [Population a] -&gt; [Population a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Population a]
</span><a href="#local-6989586621679041459"><span class="hs-identifier hs-var">pops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041458"><span class="hs-identifier hs-var">gs3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>      </span><span id="local-6989586621679041460"><span class="annot"><span class="annottext">runPar :: EvoCycle a
-&gt; Interpreter a
-&gt; [StdGen]
-&gt; Population a
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
</span><a href="#local-6989586621679041460"><span class="hs-identifier hs-var hs-var">runPar</span></a></span></span><span> </span><span id="local-6989586621679041457"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041457"><span class="hs-identifier hs-var">evo</span></a></span></span><span> </span><span id="local-6989586621679041456"><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041456"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679041455"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041455"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679041454"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041454"><span class="hs-identifier hs-var">pop'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [(a, StdGen)]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
forall a a.
IO [(a, a)]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Vector a, [a])
</span><a href="#local-6989586621679041453"><span class="hs-identifier hs-var">splitResponse</span></a></span><span>
</span><span id="line-445"></span><span>                            </span><span class="annot"><span class="annottext">(IO [(a, StdGen)]
 -&gt; ReaderT
      (Interpreter a) (StateT StdGen IO) (Population a, [StdGen]))
-&gt; IO [(a, StdGen)]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Comp
-&gt; ((a, StdGen) -&gt; IO (a, StdGen))
-&gt; [(a, StdGen)]
-&gt; IO [(a, StdGen)]
forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(MonadUnliftIO m, Traversable t) =&gt;
Comp -&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">traverseConcurrently</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Comp
</span><span class="hs-identifier hs-var">ParN</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Interpreter a -&gt; Population a -&gt; (a, StdGen) -&gt; IO (a, StdGen)
forall a.
(NFData a, Solution a) =&gt;
EvoCycle a
-&gt; Interpreter a -&gt; Population a -&gt; (a, StdGen) -&gt; IO (a, StdGen)
</span><a href="#local-6989586621679041451"><span class="hs-identifier hs-var">runCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041457"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041456"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041454"><span class="hs-identifier hs-var">pop'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-446"></span><span>                            </span><span class="annot"><span class="annottext">([(a, StdGen)] -&gt; IO [(a, StdGen)])
-&gt; [(a, StdGen)] -&gt; IO [(a, StdGen)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [StdGen] -&gt; [(a, StdGen)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a -&gt; [a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041454"><span class="hs-identifier hs-var">pop'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041455"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>      </span><span id="local-6989586621679041453"><span class="annot"><span class="annottext">splitResponse :: IO [(a, a)]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Vector a, [a])
</span><a href="#local-6989586621679041453"><span class="hs-identifier hs-var hs-var">splitResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(a, a)] -&gt; (Vector a, [a]))
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) [(a, a)]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Vector a, [a])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a], [a]) -&gt; [(a, a)] -&gt; (Vector a, [a])
forall a a. ([a], [a]) -&gt; [(a, a)] -&gt; (Vector a, [a])
</span><a href="#local-6989586621679041450"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT (Interpreter a) (StateT StdGen IO) [(a, a)]
 -&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Vector a, [a]))
-&gt; (IO [(a, a)]
    -&gt; ReaderT (Interpreter a) (StateT StdGen IO) [(a, a)])
-&gt; IO [(a, a)]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Vector a, [a])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO [(a, a)] -&gt; ReaderT (Interpreter a) (StateT StdGen IO) [(a, a)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-450"></span><span>          </span><span id="local-6989586621679041450"><span class="annot"><span class="annottext">go :: ([a], [a]) -&gt; [(a, a)] -&gt; (Vector a, [a])
</span><a href="#local-6989586621679041450"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041448"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041448"><span class="hs-identifier hs-var">accP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041447"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041447"><span class="hs-identifier hs-var">accG</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041448"><span class="hs-identifier hs-var">accP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041447"><span class="hs-identifier hs-var">accG</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>          </span><span class="annot"><a href="#local-6989586621679041450"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041446"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041446"><span class="hs-identifier hs-var">accP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041445"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041445"><span class="hs-identifier hs-var">accG</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679041444"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041444"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041443"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041443"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041442"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679041442"><span class="hs-identifier hs-var">pgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a], [a]) -&gt; [(a, a)] -&gt; (Vector a, [a])
</span><a href="#local-6989586621679041450"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041444"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041446"><span class="hs-identifier hs-var">accP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041443"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679041445"><span class="hs-identifier hs-var">accG</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679041442"><span class="hs-identifier hs-var">pgs</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>      </span><span id="local-6989586621679041451"><span class="annot"><span class="annottext">runCycle :: EvoCycle a
-&gt; Interpreter a -&gt; Population a -&gt; (a, StdGen) -&gt; IO (a, StdGen)
</span><a href="#local-6989586621679041451"><span class="hs-identifier hs-var hs-var">runCycle</span></a></span></span><span> </span><span id="local-6989586621679041441"><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041441"><span class="hs-identifier hs-var">evo</span></a></span></span><span> </span><span id="local-6989586621679041440"><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041440"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679041439"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041439"><span class="hs-identifier hs-var">pop'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041438"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041438"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041437"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041437"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, StdGen) -&gt; (a, StdGen)
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">((a, StdGen) -&gt; (a, StdGen)) -&gt; IO (a, StdGen) -&gt; IO (a, StdGen)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO a -&gt; StdGen -&gt; IO (a, StdGen)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var hs-var">runStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT (Interpreter a) (StateT StdGen IO) a
-&gt; Interpreter a -&gt; StateT StdGen IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
forall a.
(Solution a, NFData a) =&gt;
EvoCycle a
-&gt; Population a
-&gt; a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) a
</span><a href="Control.Evolution.html#evalCycle"><span class="hs-identifier hs-var">evalCycle</span></a></span><span> </span><span class="annot"><span class="annottext">EvoCycle a
</span><a href="#local-6989586621679041441"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041439"><span class="hs-identifier hs-var">pop'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041438"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Interpreter a
</span><a href="#local-6989586621679041440"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041437"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- | Generates the evolutionary process to be evaluated using `runEvolution`</span><span>
</span><span id="line-456"></span><span id="local-6989586621679041721"><span class="annot"><a href="Control.Evolution.html#genEvolution"><span class="hs-identifier hs-type">genEvolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-458"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span>
</span><span id="line-459"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-460"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-type">Evolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span>
</span><span id="line-461"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679041721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-462"></span><span id="genEvolution"><span class="annot"><span class="annottext">genEvolution :: Int
-&gt; Int
-&gt; (Population a -&gt; IO ())
-&gt; Evolution a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
</span><a href="Control.Evolution.html#genEvolution"><span class="hs-identifier hs-var hs-var">genEvolution</span></a></span></span><span> </span><span id="local-6989586621679041433"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041433"><span class="hs-identifier hs-var">nGens</span></a></span></span><span> </span><span id="local-6989586621679041432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041432"><span class="hs-identifier hs-var">nPop</span></a></span></span><span> </span><span id="local-6989586621679041431"><span class="annot"><span class="annottext">Population a -&gt; IO ()
</span><a href="#local-6989586621679041431"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621679041430"><span class="annot"><span class="annottext">Evolution a
</span><a href="#local-6989586621679041430"><span class="hs-identifier hs-var">evo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621679041429"><span class="annot"><span class="annottext">Rnd a
</span><a href="#local-6989586621679041429"><span class="hs-identifier hs-var">createSol</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; Rnd a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; Rnd a
forall a. Interpreter a -&gt; Rnd a
</span><a href="Control.Evolution.html#_create"><span class="hs-identifier hs-var hs-var">_create</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621679041428"><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041428"><span class="hs-identifier hs-var">eval</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Interpreter a -&gt; a -&gt; Rnd a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (a -&gt; Rnd a)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">Interpreter a -&gt; a -&gt; Rnd a
forall a. Interpreter a -&gt; a -&gt; Rnd a
</span><a href="Control.Evolution.html#_evaluate"><span class="hs-identifier hs-var hs-var">_evaluate</span></a></span><span> </span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621679041427"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041427"><span class="hs-identifier hs-var">pop0</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO (Population a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(StateT StdGen IO (Population a)
 -&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a))
-&gt; StateT StdGen IO (Population a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) (Population a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rnd a -&gt; StateT StdGen IO (Population a)
forall (m :: * -&gt; *) a. Monad m =&gt; Int -&gt; m a -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041432"><span class="hs-identifier hs-var">nPop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rnd a
</span><a href="#local-6989586621679041429"><span class="hs-identifier hs-var">createSol</span></a></span><span> </span><span class="annot"><span class="annottext">Rnd a -&gt; (a -&gt; Rnd a) -&gt; Rnd a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rnd a
</span><a href="#local-6989586621679041428"><span class="hs-identifier hs-var">eval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621679041425"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041425"><span class="hs-identifier hs-var">g</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO StdGen
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) StdGen
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO StdGen
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ())
-&gt; IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; IO ()
</span><a href="#local-6989586621679041431"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041427"><span class="hs-identifier hs-var">pop0</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="annottext">Int
-&gt; Population a
-&gt; ([Double], a)
-&gt; [StdGen]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
</span><a href="#local-6989586621679041423"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041433"><span class="hs-identifier hs-var">nGens</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041427"><span class="hs-identifier hs-var">pop0</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Population a -&gt; Double
forall a. Solution a =&gt; Vector a -&gt; Double
</span><a href="Control.Evolution.html#avgFit"><span class="hs-identifier hs-var">avgFit</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041427"><span class="hs-identifier hs-var">pop0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Population a -&gt; a
forall a. Ord a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimum</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041427"><span class="hs-identifier hs-var">pop0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([StdGen]
 -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a))
-&gt; [StdGen]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; StdGen -&gt; [StdGen]
</span><a href="Control.Evolution.html#splitGensWithIndex"><span class="hs-identifier hs-var">splitGensWithIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041432"><span class="hs-identifier hs-var">nPop</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041425"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-470"></span><span>      </span><span id="local-6989586621679041423"><span class="annot"><span class="annottext">go :: Int
-&gt; Population a
-&gt; ([Double], a)
-&gt; [StdGen]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
</span><a href="#local-6989586621679041423"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Population a
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679041419"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679041419"><span class="hs-identifier hs-var">avgs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041418"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041418"><span class="hs-identifier hs-var">best</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041417"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041417"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Double], a)
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679041419"><span class="hs-identifier hs-var">avgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041418"><span class="hs-identifier hs-var">best</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>      </span><span class="annot"><a href="#local-6989586621679041423"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679041415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041415"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679041414"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041414"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679041413"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679041413"><span class="hs-identifier hs-var">avgs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041412"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041412"><span class="hs-identifier hs-var">best</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679041411"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041411"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041410"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041410"><span class="hs-identifier hs-var">pop'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041409"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041409"><span class="hs-identifier hs-var">gs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Evolution a
-&gt; Population a
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
forall a.
(Solution a, NFData a) =&gt;
Evolution a
-&gt; Population a
-&gt; [StdGen]
-&gt; ReaderT
     (Interpreter a) (StateT StdGen IO) (Population a, [StdGen])
</span><a href="Control.Evolution.html#evalEvo"><span class="hs-identifier hs-var">evalEvo</span></a></span><span> </span><span class="annot"><span class="annottext">Evolution a
</span><a href="#local-6989586621679041430"><span class="hs-identifier hs-var">evo</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041414"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041411"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-472"></span><span>                                      </span><span class="annot"><span class="annottext">IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ())
-&gt; IO () -&gt; ReaderT (Interpreter a) (StateT StdGen IO) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; IO ()
</span><a href="#local-6989586621679041431"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041410"><span class="hs-identifier hs-var">pop'</span></a></span><span>
</span><span id="line-473"></span><span>                                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041408"><span class="annot"><span class="annottext">avgs' :: [Double]
</span><a href="#local-6989586621679041408"><span class="hs-identifier hs-var hs-var">avgs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double]
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; [Double]) -&gt; [Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Double
forall a. Solution a =&gt; Vector a -&gt; Double
</span><a href="Control.Evolution.html#avgFit"><span class="hs-identifier hs-var">avgFit</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041410"><span class="hs-identifier hs-var">pop'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Double] -&gt; [Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679041413"><span class="hs-identifier hs-var">avgs</span></a></span><span>
</span><span id="line-474"></span><span>                                          </span><span id="local-6989586621679041407"><span class="annot"><span class="annottext">best' :: a
</span><a href="#local-6989586621679041407"><span class="hs-identifier hs-var hs-var">best'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Population a -&gt; a
forall a. Solution a =&gt; a -&gt; Vector a -&gt; a
</span><a href="Control.Evolution.html#getBest"><span class="hs-identifier hs-var">getBest</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041412"><span class="hs-identifier hs-var">best</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041410"><span class="hs-identifier hs-var">pop'</span></a></span><span>
</span><span id="line-475"></span><span>                                      </span><span class="annot"><span class="annottext">Int
-&gt; Population a
-&gt; ([Double], a)
-&gt; [StdGen]
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
</span><a href="#local-6989586621679041423"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041415"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679041410"><span class="hs-identifier hs-var">pop'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679041408"><span class="hs-identifier hs-var">avgs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041407"><span class="hs-identifier hs-var">best'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679041409"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">-- | Runs the evolutionary process </span><span>
</span><span id="line-478"></span><span id="local-6989586621679041405"><span class="annot"><a href="Control.Evolution.html#runEvolution"><span class="hs-identifier hs-type">runEvolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ number of generations </span><span>
</span><span id="line-479"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                        </span><span class="hs-comment">-- ^ population size</span><span>
</span><span id="line-480"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Evolution.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ a logger function to run at every generation </span><span>
</span><span id="line-481"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Evolution"><span class="hs-identifier hs-type">Evolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span>                </span><span class="hs-comment">-- ^ Evolutionary process </span><span>
</span><span id="line-482"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span>                     </span><span class="hs-comment">-- ^ random number generator</span><span>
</span><span id="line-483"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Evolution.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ Interpreter of evolutionary process </span><span>
</span><span id="line-484"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679041405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- ^ returns the average fitness of every generation and the final champion</span></span><span>
</span><span id="line-485"></span><span id="runEvolution"><span class="annot"><span class="annottext">runEvolution :: Int
-&gt; Int
-&gt; (Population a -&gt; IO ())
-&gt; Evolution a
-&gt; StdGen
-&gt; Interpreter a
-&gt; IO ([Double], a)
</span><a href="Control.Evolution.html#runEvolution"><span class="hs-identifier hs-var hs-var">runEvolution</span></a></span></span><span> </span><span id="local-6989586621679041404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041404"><span class="hs-identifier hs-var">nGens</span></a></span></span><span> </span><span id="local-6989586621679041403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041403"><span class="hs-identifier hs-var">nPop</span></a></span></span><span> </span><span id="local-6989586621679041402"><span class="annot"><span class="annottext">Population a -&gt; IO ()
</span><a href="#local-6989586621679041402"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621679041401"><span class="annot"><span class="annottext">Evolution a
</span><a href="#local-6989586621679041401"><span class="hs-identifier hs-var">evo</span></a></span></span><span> </span><span id="local-6989586621679041400"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041400"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StateT StdGen IO ([Double], a) -&gt; StdGen -&gt; IO ([Double], a))
-&gt; StdGen -&gt; StateT StdGen IO ([Double], a) -&gt; IO ([Double], a)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT StdGen IO ([Double], a) -&gt; StdGen -&gt; IO ([Double], a)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041400"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT StdGen IO ([Double], a) -&gt; IO ([Double], a))
-&gt; (Interpreter a -&gt; StateT StdGen IO ([Double], a))
-&gt; Interpreter a
-&gt; IO ([Double], a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
-&gt; Interpreter a -&gt; StateT StdGen IO ([Double], a)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; (Population a -&gt; IO ())
-&gt; Evolution a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
forall a.
(Solution a, NFData a) =&gt;
Int
-&gt; Int
-&gt; (Population a -&gt; IO ())
-&gt; Evolution a
-&gt; ReaderT (Interpreter a) (StateT StdGen IO) ([Double], a)
</span><a href="Control.Evolution.html#genEvolution"><span class="hs-identifier hs-var">genEvolution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041404"><span class="hs-identifier hs-var">nGens</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041403"><span class="hs-identifier hs-var">nPop</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; IO ()
</span><a href="#local-6989586621679041402"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Evolution a
</span><a href="#local-6989586621679041401"><span class="hs-identifier hs-var">evo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="annot"><a href="Control.Evolution.html#splitGensWithIndex"><span class="hs-identifier hs-type">splitGensWithIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span id="splitGensWithIndex"><span class="annot"><span class="annottext">splitGensWithIndex :: Int -&gt; StdGen -&gt; [StdGen]
</span><a href="Control.Evolution.html#splitGensWithIndex"><span class="hs-identifier hs-var hs-var">splitGensWithIndex</span></a></span></span><span> </span><span id="local-6989586621679041397"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041397"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((StdGen, StdGen) -&gt; StdGen) -&gt; [(StdGen, StdGen)] -&gt; [StdGen]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(StdGen, StdGen) -&gt; StdGen
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(StdGen, StdGen)] -&gt; [StdGen])
-&gt; (StdGen -&gt; [(StdGen, StdGen)]) -&gt; StdGen -&gt; [StdGen]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(StdGen, StdGen)] -&gt; [(StdGen, StdGen)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041397"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([(StdGen, StdGen)] -&gt; [(StdGen, StdGen)])
-&gt; (StdGen -&gt; [(StdGen, StdGen)]) -&gt; StdGen -&gt; [(StdGen, StdGen)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((StdGen, StdGen) -&gt; (StdGen, StdGen))
-&gt; (StdGen, StdGen) -&gt; [(StdGen, StdGen)]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679041394"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041394"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041393"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041393"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (StdGen, StdGen)
forall g. RandomGen g =&gt; g -&gt; (g, g)
</span><span class="hs-identifier hs-var">split</span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679041393"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StdGen, StdGen) -&gt; [(StdGen, StdGen)])
-&gt; (StdGen -&gt; (StdGen, StdGen)) -&gt; StdGen -&gt; [(StdGen, StdGen)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (StdGen, StdGen)
forall g. RandomGen g =&gt; g -&gt; (g, g)
</span><span class="hs-identifier hs-var">split</span></span><span> </span><span>
</span><span id="line-490"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Control.Evolution.html#splitGensWithIndex"><span class="hs-pragma hs-type">splitGensWithIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span id="local-6989586621679041733"><span class="annot"><a href="Control.Evolution.html#avgFit"><span class="hs-identifier hs-type">avgFit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041733"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679041733"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-493"></span><span id="avgFit"><span class="annot"><span class="annottext">avgFit :: Vector a -&gt; Double
</span><a href="Control.Evolution.html#avgFit"><span class="hs-identifier hs-var hs-var">avgFit</span></a></span></span><span> </span><span id="local-6989586621679041391"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041391"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sum Double -&gt; Double
forall a. Sum a -&gt; a
</span><span class="hs-identifier hs-var hs-var">getSum</span></span><span> </span><span class="annot"><span class="annottext">Sum Double
</span><a href="#local-6989586621679041389"><span class="hs-identifier hs-var">tot</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041391"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679041389"><span class="annot"><span class="annottext">tot :: Sum Double
</span><a href="#local-6989586621679041389"><span class="hs-identifier hs-var hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Sum Double) -&gt; Vector a -&gt; Sum Double
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Sum Double
forall a. a -&gt; Sum a
</span><span class="hs-identifier hs-var">Sum</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Sum Double) -&gt; (a -&gt; Double) -&gt; a -&gt; Sum Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a. Solution a =&gt; a -&gt; Double
</span><a href="Control.Evolution.html#_getFitness"><span class="hs-identifier hs-var">_getFitness</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041391"><span class="hs-identifier hs-var">pop</span></a></span><span>
</span><span id="line-496"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Control.Evolution.html#avgFit"><span class="hs-pragma hs-type">avgFit</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span id="local-6989586621679041729"><span class="annot"><a href="Control.Evolution.html#getBest"><span class="hs-identifier hs-type">getBest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Evolution.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679041729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679041729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679041729"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-499"></span><span id="getBest"><span class="annot"><span class="annottext">getBest :: a -&gt; Vector a -&gt; a
</span><a href="Control.Evolution.html#getBest"><span class="hs-identifier hs-var hs-var">getBest</span></a></span></span><span> </span><span id="local-6989586621679041386"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span></span><span> </span><span id="local-6989586621679041385"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041385"><span class="hs-identifier hs-var">pop</span></a></span></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Bool
forall a. Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041384"><span class="hs-identifier hs-var">feasible</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Solution a =&gt; a -&gt; Bool
</span><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-var">_isFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Bool
forall a. Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041384"><span class="hs-identifier hs-var">feasible</span></a></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Ord a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimum</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041385"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Solution a =&gt; a -&gt; Bool
</span><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-var">_isFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679041386"><span class="hs-identifier hs-var">best</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Ord a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimum</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041384"><span class="hs-identifier hs-var">feasible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Ord a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.minimum</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041384"><span class="hs-identifier hs-var">feasible</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679041384"><span class="annot"><span class="annottext">feasible :: Vector a
</span><a href="#local-6989586621679041384"><span class="hs-identifier hs-var hs-var">feasible</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Vector a -&gt; Vector a
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.filter</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. Solution a =&gt; a -&gt; Bool
</span><a href="Control.Evolution.html#_isFeasible"><span class="hs-identifier hs-var">_isFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679041385"><span class="hs-identifier hs-var">pop</span></a></span><span>
</span><span id="line-506"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Control.Evolution.html#getBest"><span class="hs-pragma hs-type">getBest</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-507"></span></pre></body></html>